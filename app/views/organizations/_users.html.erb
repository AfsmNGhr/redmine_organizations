<div class="splitcontentleft">
<% if @organization.users.any? %>
	<table class="list users">
		<thead><tr>
		  <th><%= l(:label_user) %></th>
		  <th style="width:15%"></th>
		</tr></thead>
		<tbody>
		<% @organization.users.sort.each do |user| %>
			<tr id="user-<%= user.id %>" class="<%= cycle 'odd', 'even' %>">
				<td class="user"><%= link_to_user user %></td>
			  <td class="buttons">
			      <%= link_to_remote l(:button_delete), { :url => { :controller => 'organizations', :action => 'remove_user', :id => @organization, :user_id => user },
			      																				:method => :post },
			      																		  :class => 'icon icon-del' %>
			  </td>
			</tr>
		<% end %>
		</tbody>
	</table>
<% else %>
	<p class="nodata"><%= l(:label_no_data) %></p>
<% end %>
</div>

<div class="splitcontentright">
<% users = User.active.find(:all, :limit => 100) - @organization.users %>
<% if users.any? %>
  <%= form_for(@organization, :as => :organization, :remote => true, :url => {:controller => 'organizations', :action => 'add_users', :id => @organization}, :method => :post) do |f| %>
    <fieldset><legend><%=l(:label_user_new)%></legend>
    
    <p><%= text_field_tag 'user_search', nil %></p>
		<%= observe_field(:user_search,
                 :frequency => 0.5,
                 :update => :users,
                 :url => { :controller => 'organizations', :action => 'autocomplete_for_user', :id => @organization },
                 :with => 'q')
                  %>
		
		<div id="users">
      <% users.sort.each do |user| -%>
        <label><%= check_box_tag 'user_ids[]', user.id, false %> <%= h user %></label>
      <% end -%>
		</div>
   	
    <p><%= submit_tag l(:button_add) %></p>
		</fieldset>
  <% end %>
<% end %>

</div>
